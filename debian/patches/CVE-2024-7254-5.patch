Backport of:

From b5a7cf7cf4b7e39f6b02205e45afe2104a7faf81 Mon Sep 17 00:00:00 2001
From: Sandy Zhang <sandyzhang@google.com>
Date: Wed, 18 Sep 2024 15:25:25 -0400
Subject: [PATCH 5/5] Remove RecursiveGroup test case which doesn't exist in
 25.x pre-Editions

---
 .../java/com/google/protobuf/LiteTest.java    | 20 -------------------
 src/google/protobuf/unittest_lite.proto       |  4 ----
 2 files changed, 24 deletions(-)

Index: protobuf-3.12.4/java/lite/src/test/java/com/google/protobuf/LiteTest.java
===================================================================
--- protobuf-3.12.4.orig/java/lite/src/test/java/com/google/protobuf/LiteTest.java
+++ protobuf-3.12.4/java/lite/src/test/java/com/google/protobuf/LiteTest.java
@@ -39,7 +39,6 @@ import com.google.protobuf.UnittestImpor
 import com.google.protobuf.UnittestImportPublicLite.PublicImportMessageLite;
 import com.google.protobuf.UnittestLite.ForeignEnumLite;
 import com.google.protobuf.UnittestLite.ForeignMessageLite;
-import com.google.protobuf.UnittestLite.RecursiveGroup;
 import com.google.protobuf.UnittestLite.TestAllExtensionsLite;
 import com.google.protobuf.UnittestLite.TestAllTypesLite;
 import com.google.protobuf.UnittestLite.TestAllTypesLite.NestedEnum;
@@ -2291,16 +2290,6 @@ public class LiteTest extends TestCase {
     assertThat(thrown).hasMessageThat().contains("Protocol message had too many levels of nesting");
   }
 
-  public void testParseFromBytes_recursiveKnownGroups() throws Exception {
-    byte[] data99 = makeRecursiveGroup(99).toByteArray();
-    byte[] data100 = makeRecursiveGroup(100).toByteArray();
-
-    RecursiveGroup unused = RecursiveGroup.parseFrom(data99);
-    Throwable thrown =
-        assertThrows(InvalidProtocolBufferException.class, () -> RecursiveGroup.parseFrom(data100));
-    assertThat(thrown).hasMessageThat().contains("Protocol message had too many levels of nesting");
-  }
-
   @SuppressWarnings("ProtoParseFromByteString")
   public void testMaliciousSGroupTagsWithMapField_fromByteArray() throws Exception {
     ByteString byteString = generateNestingGroups(102);
@@ -2676,12 +2665,4 @@ public class LiteTest extends TestCase {
       return RecursiveMessage.newBuilder().setRecurse(makeRecursiveMessage(num - 1)).build();
     }
   }
-
-  private static RecursiveGroup makeRecursiveGroup(int num) {
-    if (num == 0) {
-      return RecursiveGroup.getDefaultInstance();
-    } else {
-      return RecursiveGroup.newBuilder().setRecurse(makeRecursiveGroup(num - 1)).build();
-    }
-  }
 }
Index: protobuf-3.12.4/src/google/protobuf/unittest_lite.proto
===================================================================
--- protobuf-3.12.4.orig/src/google/protobuf/unittest_lite.proto
+++ protobuf-3.12.4/src/google/protobuf/unittest_lite.proto
@@ -489,7 +489,3 @@ message DupEnum {
     BAR2 = 2;
   }
 }
-
-message RecursiveGroup {
-  optional RecursiveGroup recurse = 1 [features.message_encoding = DELIMITED];
-}
